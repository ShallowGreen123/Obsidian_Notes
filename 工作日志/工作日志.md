
# 参与的项目

# 2023 年
## 10月
10.19
办理入职手续，熟悉工作环境，熟悉 T-Display-S3-Long 开发环境

10.20
解决项目 T-Display-S3-Long 中的翻页时钟动效，使用 canvas 方式绘制动画，在模拟器上运行结果不太行

10.21 ---

10.22 ---

10.23
在模拟器中实现翻页时钟的效果，从视频转为GIF后画面颗粒感很明显

10.24
把模拟器的时钟翻页效果移植到实机中，完成演示 demo；熟悉固件打包流程

10.25
#问题 【T-Display-S3-Long] 修复模拟翻页时钟的一些问题，上传代码；熟悉 PlatformIO 的开发环境；
~~~
1️⃣ 一些低版本的 lvgl 在显示 GIF 是会一直重复播放，尽管原文件只播放一次；建议使用 lvgl 8.3.10 或以上版本。
~~~

10.26
重新实现 T-Touchbar-AMOLED 的 UI 交互界面，在模拟器中实现 demo；修复原来 UI 显示特定单词画面错位的问题；

10.27
在实机上实现新的 UI 交互界面，测试基本功能正常；

10.28
#问题 【T-Display-S3-Long] 完成 T-Display-S3-Long 的配网功能；解决板子在上电显示 UI 前会有短暂花屏的问题；
~~~
1️⃣ 应该在 UI 运行起来后，在开启背光，不然就可能出现上电短暂花屏的现象；
~~~

10.29 ---

10.30
参考 CameraWebServer 例程在项目 T-Display-S3-Pro 实现了web摄像头的的功能

10.31
参考已经有的例程，实现了摄像头拍摄的画面，在显示屏上显示的例子

## 11月
11.01
将摄像头的功能集成到 T-Display-S3-Pro 的 factory 的相机中

11.02
实现摄像头画面旋转，但是画面会有撕裂，采用 LVGL 实现软件旋转图像会很吃算力

11.03
完成摄像头的拍照功能，添加一些自定义按键

11.04
学习 LTR553ALS 数字感光距离传感器，学习 C++的基本语法

11.05 ---

11.06
代码中添加 T-Touchbar-AMOLED 翻转屏幕的配置；将 LTR553ALS 集成到 T-Display-S3-Pro 项目中，实现屏幕有物体覆盖就息屏的功能；

11.07
#问题 【T-Display-S3-Pro】学习 esp camera 项目代码，为解决 S3-Pro 项目中 camera 放在最后初始化导致摄像头不能使用的问题(原因是esp camera使用的idf的方式会重新初始化I2Cport)
~~~
1️⃣因为工程中的 esp camera 库使用的 I2C 是用 IDF 实现的，其他库的 I2C 用 Arduion 实现的，在其他 Arduion I2C 模块初始化后，在初始化摄像头，就会导致摄像头不能工作；
🔧 解决方法是 (1) 摄像头初始化放到最前；(2) 或者用 Arduion Wire 重新实现 esp camera 库
~~~

11.08
解决 GitHub 上 S3-Long 项目用户提出的问题，并给出答复；搭建 esp32C6 Arduion 开发环境 

11.09
驱动 MotorDriver-C6 的电机(没能能转起来，但可以调整电机转动的阻尼)，因为 Arduion 开发 C6 比较新，还不支持 SimpleFOC 库；

11.10
#问题 【T-Display-S3-Pro】解决 S3-Pro 项目中 OV5640 的自动对焦问题(参考：https://github.com/0015/ESP32-OV5640-AF)；

11.11
使用 H_ON、L_ON 的方式驱动BLDC直流无刷电机；驱动 MT6701 磁编码器

11.12 ---

11.13
以快速开关的方式驱动 MotorDriver-C6 的电机（可以转起来了）
参考：https://www.digikey.com/en/articles/how-to-power-and-control-brushless-dc-motors

11.14
使用FOC开环速度控制，驱动 MotorDriver-C6 的电机

11.15
学习SD卡相关的内容

11.16
在 S3-Pro 中成功驱动 SD card；(SD 和 屏幕共用一个 SPI，开始没有注意，现在解决了)

11.17
完成 S3-Pro 中相册可以查看图片的功能

11.18 ---

11.19 ---

11.20
完成 S3-Pro 相机拍照存到 SD 卡中，然后通过相册查看相机排到的照片的功能(当前用的jpg格式，需要编解码，所以比较慢，而且有时会出现内存错误)

11.21
完成 S3-Pro 拍照功能（采用 bmp 图片的格式，因为摄像头拍到的画面可以直接显示到 lv_canvas 上不需要解码，然后 lv_canvas 上的画面可以加一个 bmp 格式的 head 保存到 sd 卡中，比较快速）

11.22
测试整理 S3-Pro 添加拍照、相册、距离传感器的功能作为一个例程，上传代码

11.23
阅读 smartKnob 开源项目源码，熟悉项目流程

11.24
使用 esp32C6 的 MCPWM 驱动电机

11.25 ---

11.26 ---

11.27
完成一个 MCPWM 加 FOC 开环速度控制的列子，强制生成的电角度会使运动的电机碰停时发生剧烈抖动

11.28
解决昨天的问题，使用磁编码器为电机的转动提供电角度，转动时更加的丝滑

11.29
完成一个闭环位置控制和速度控制例程，以库的形式整理代码

11.30
完成一个PID加低通滤波控制的例程，将前面的例子集成到第8个例子中，通过按键切换不同的电机效果

## 12月
12.01
整理前面无刷电机代码，熟悉 T-watch-S3 项目

12.02 ---

12.03 ---

12.04
点亮 T-Circla 项目的屏幕，但是颜色不对，熟悉 TFT_eSPI

12.05
解决屏幕颜色不正确的问题，弄了一个模拟时钟的demo

12.06
完成 lvgl 界面管理，参考 MVC 模型，界面管理定义了界面的活跃状态、生命周期等特性，通过出栈入栈的方式切换界面，支持切换动画

12.07
熟悉 TX-AH-R900P 开发板，收集开发板相关的资料

12.08
阅读 TX-AH-R900P 开发板模组的资料，主要是用 AT 指令去配置一些设置

12.09 ---

12.10 ---

12.11
搭建 esp32 与 TX-AH-R900P 开发板的环境，熟悉 Ethernet 和 RMII 等一些东西，这些给我整不会了

12.12
解决 GC0308 设置头画面翻转问题(esp32_camera 库的 GC0308 的垂直翻转的功能没有用，自己用的软件翻转的)

12.13
解决 S3-Pro 项目异常息屏的问题，解决方法在控制菜单中添加一个按键控制 ALS 传感器的工作

12.14
驱动振动马达；搭建 esp-idf 开发环境(为更清晰地看到函数的调用关系)

12.15
学习网口相关的内容，TX-AH-R900P 的 ETH MAC 通过 RMII 接口与 esp32 的 ETH MAC 接口相连，中间没有 PHY 层

12.16 ---

12.17 ---

12.18
使用 esp32 的 RMII 驱动 R900P 模组，尝试用 esp-idf 驱动

12.19
今天调了一天的 R900P 模组与 esp32 通信，没有成功

12.20
分析 esp-idf 关于 Ethernet 的实现方法，问了商家模组是外接RJ45, 外挂MCU通过AT处理数据的，没用办法通过 RMII通信，暂时先搁置

12.21
11月份是驱动了 BLDC 电机，没有写文档，今天写了关于 BLDC 电机简介

12.22
写了关于 Clark变换的文档，梳理整个 BLDC电机驱动过程

12.23
驱动新版的 Motor-C6 电机，整理电机相关的代码，继续完善关于 Clark变换的文档

12.24 ---

12.25
写 S3-Pro 计算器的UI

12.26
驱动 icm20948 9轴传感器，读取3 轴加速度计、3轴陀螺仪、3轴磁力计

12.27
完成 9轴传感器的演示 demo，上传到 github 中 S3-Pro的例子中

12.28
完成 S3-Pro例子 cellphone中的计算器功能，并上传到 GitHub；点亮 T-Circle 触摸屏显示 

12.29 ---

12.30 
解决 T-Circle 红蓝颜色显示相反的问题

12.31 ---

# 2024 年
## 1月
01.01 ---

01.02
驱动 T-Circle 的触摸功能，完成一个演示demo；验证 github 上 S3-Pro 用户提出的问题

01.03
添加9周传感器库S3-Pro；消除例子 cellphone 和 ICM20948 在 Arduion 环境下的编译错误

01.04
写测试触摸屏休眠唤醒demo，测试触摸屏功耗；添加 sensorlib 当前触摸屏驱动id并推送github
触摸屏功耗
sleep：   1.1 uA
不触摸：1.75 mA
触摸：    1.84 mA

01.05
规范 T-Circle UI 的流程综合前面的 demo完成一个切屏的效果；

01.06
优化 T-Circle UI 的运行速度；优化屏幕切换逻辑；

01.07 ---

01.08
驱动 T_Encoder_Plus_S3 项目的显示屏、触摸屏和编码器；

01.09
T_Encoder_Plus_S3 搭建 UI 框架，界面管理；编写测试 LVGL 测试 demo

01.10
T_Encoder_Plus_S3 设计和实现 UI 界面，大致框架为1个一级界面、7个二级页面和其它 N 级页面；进度：完成触摸屏和编码器与 LVGL 对接，完成一级主界面；

01.11
完成1一个二级测试界面，并添加了6个测试程序，包括测试触摸屏、编码器、屏幕颜色和对比度、边缘界面等测试程序；

01.12
完成设置界面 UI 并和硬件对接起来

01.13
完成了时钟和仪表盘页面，并对每个二级界面添加了相应的简单组件

01.14 ---

01.15
基本上完成了整个 UI 实现；添加 ws2812 驱动，并添加相应的组件控制 ws2812 小灯

01.16
协助硬件排查 Motor-C6 项目的问题；

01.17
更换新的 UI 图标，规范每一个 UI  的子界面，使用界面的注册的方式；解耦 UI 和底层数据的对接

01.18
完成系统参数掉电保存到 eeprom 中；添加配网界面和 UI 说明文档(通过扫描二维码的方式获取文档)

01.19
解决 S3-pro 摄像头翻转的问题

01.20 --- 年会

01.21 ---

01.22
T_Encoder_Plus_S3 项目基本已完成，开始新的 T-Deskpro 项目，熟悉项目环境

01.23
尝试驱动墨水屏，但是程序时而能行时而不能行，怀疑是屏幕触电接触不良，暂时先放着

01.24
完成 T-Deskpro 的键盘功能，通过回调的方式获取键值

01.25
完成 T-Deskpro 的扩展 IO 芯片驱动

01.26
驱动 T-Deskpro 墨水屏显示一些图片，熟悉 GxEPD 库

01.27 ---

01.28 ---

01.29
新板子回来，点亮了屏幕没有之前刷新屏幕那么慢；熟悉 GxEPD 的一些例程；

01.30
解决前面墨水瓶刷新太慢的问题, 并设计了一些icon;

01.31
设计项目界面的主界面， 确定界面显示的基本框架；


## 2月
02.01
完成驱动项目的触摸屏，并和主界面对接起来；因为 ink 屏幕没有现成的 UI 框架，实现 UI 的过程有点慢；

02.02
完成 SD 卡读取文件的功能；添加触摸测试例程；

02.03
调整 UI 的布局，编写一些绘制 UI 位置的接口函数；

02.04 ---

02.18 ---

02.19
添加光照传感器和陀螺仪演示功能；

02.20
了解 Lora、GPS、A7682E 模块；阅读 Lora、GPS的文档和代码资料

02.21
完成 Lora 的演示例程，但是没有测试；优化 EPD UI  的显示；

02.22
完成 GPS 的演示程序，但是没有测试，GPS要在户外才能接收到较强的信号；

02.23
测试 Lora 的演示程序，修复出现的问题；添加 PMU 电源管理驱动和它的测试程序；修改 UI 的主菜单，优化交互逻辑；

02.24
添加自定义按键接口；添加系统信息界面的页面切换；添加 Keypad 功能演示；修改主界面 UI；

02.25 ---

02.26
#问题 【T-Display-S3-Pro 】解决 T-Display-S3-Pro 中，摄像头拍照保存到 SD 中，再把 SD 插入电脑查看时，图片颜色错误的问题；
~~~
原因是写入图片 BMP 格式不正确，更改写入正确的 BMP 格式参考下面工程：
~~~
https://github.com/Xinyuan-LilyGO/T-Display-S3-Pro

02.27
添加系统信息界面和系统信息显示接口，可以分页切换查看信息；

02.28
T-Holaw 项目，搭建开发环境，驱动摄像头，添加一个web摄像头的演示程序；

02.29
开始驱动 TX-AH-Rx00p 无线通信模块，和硬件协助不能识别 usb 和不能更新固件的问题；

## 3月
03.01
泰芯 TX-AH-Rx00P 配对注意：
1. 看模块的左下角，7p表示700M，9p表示900M，只有两个设备具有相同的型号才可以配对成功
2. 烧录开发板 usb 固件到 flash 中，版本号为 25403，崭新的模块用烧录器下载到 flash，已经有固件的模块可以通过 AHCOM 工具更新固件
3. usb 固件的打印串口时 A10/A11，其他固件的打印串口是 A12/A13
4. 下载完固件之后，使用 AT+MODE=ap 指令将一台设备设置为 ap 模式，使用 AT+mode=sta 指令将另一台设备设置为 sta 模式
5. 配对时，需要 AP 设备和 STA 设备同时使用 AT+PAIR=1 指令，配对成功后依次使用 AT+PAIR=0 指令停止配对

03.02
解决不能识别 usb 的问题， 两个 TX-AH-Rx00P 模块通信成功

03.03 ---

03.04
搭建 CDK 的开发环境(编译 TX-AH-Rx00P 模块的固件)；熟悉 CDK 的开发烧录过程；

03.05
完成协助硬件调试 PCM5102A 音频模块，可以正常播放声音；学习 hgSDK 的一些接口，这些接口缺少文档和例子理解起来比较困难；

03.06
阅读 hgSDK 的源码，开始驱动 TX-AH-Rx00p 模块的外设，如 GPIO、定时器等；hgSDK 源码没有注释也没有例子；

03.07
写 T-Desk-pro 测试固件协助硬件排查打开所有外设的电源和功耗问题；尝试用 hgSDK 建立 SDIO 通信；

03.08
尝试建立 SDIO 与 esp32 之间的通信，失败；TX-AH-Rx00P 开发板上没有可以驱动的外设，不能验证代码是否正确；

03.09 ---

03.10 ---

03.11
了解 TX-AH-Rx00p 的 Ethernet 接口；了解 PlatformIO 工程的构建，分区表，构建标志等；

03.12
编写 MotorDriver-C6 的测试固件和测试说明文档；

03.13
开始尝试使用 TX-AH-Rx00p 的外设和阅读 hgSDk 的代码，了解工程的基本结构；

03.14
驱动 TX-AH-Rx00p 的一些外设，整理了一下工程结构，查看 hgSDK 中关于 ethernet 的源码；

03.15
使用 CDK 编译自定义固件，测试使用 hgSDK 中的 一些外设；

03.16
使用 esp32 和以太网模块 IP101GR 使用 esp-idf 编译，下载固件，结果一直没能获取 IP ，问题排查中；

03.17 ---

03.18
使用 T-Halow 的网口，下载泰芯提供的网口固件，接入电脑后没有任何的反应，硬件检查结果为网口时钟不正常。

03.19
了解关于分区表相关的内容

03.20 ---

03.21
T-Halow 的网口测试成功，可以通过电脑 ping 到 T-Halow；

03.22
搭建 T-Embed-PN532 项目环境，熟悉外部设备；点亮屏幕和驱动编码器；

03.23
设计 UI 的实现框架；编写屏幕和编码器的演示例程；移植 LVGL 的测试例程；

03.24 ---

03.25
实现 UI 的界面跳转逻辑，并添加一些动画；完成主界面到次级界面跳转动画；

03.26
添加 WS2812 驱动和演示例程；把 WS2812 集成到 UI 中；

03.27
优化 UI 界面的动画和布局；调试 PN532 和硬件一起排查 I2C 有时候读不到的问题；

03.28
调试型号为 CC1101 的 lora 模块， 
LORA 
- frenquency
- bandwidth
- spreading factor
- coding rate denominator
- sync word
- output power in dBm
- preamble length in symbols
- tcxoVoltage
- useRegulatorLDO

03.29
完成调试型号为 CC1101 的 lora 模块，测试验证结果正常；

03.30
完成调试型号为 PN532 的 NFC 模块和电量计 BQ25896，测试验证结果正常；

03.31 ---

## 4月
04.01
将 lora 功能以线程的方式集成到出厂程序中，解决屏幕 SPI 和 lora SPI 冲突的问题；

04.02
完成 Lora 收发功能 UI 并于硬件对接，可以在 UI 上使用 Lora 收发；

04.03
完成 NFC 的演示功能 UI ，集成到一个单独的副界面中；

04.04 ---

04.05
添加一些生成的等宽字体，替换 LVGL 自带的字体；添加电池信息显示界面

04.06
添加驱动电池管理芯片，添加电池的 UI 查看界面；

04.07 ---

04.08
完成 T-Emded-PN532 的 WiFi 配网功能，添加 UI 的提示弹窗；

04.09
解决 motor-C6 电机项目电机异常，电机不能闭环控制(位置闭环时一直转)，电机转动时有明显颗粒感，验证一个电机是否正常的步骤为：
- `1️⃣` 先要测量电机三相两两之间的内阻，正常情况下内阻为十几欧姆左右
- `2️⃣` 检测磁性传感器的方向
- `3️⃣` 检测电机的绕线方式

04.10
优化 T-Encoder-plus-S3 的 UI 界面，添加触摸按键舵机控制演示；完成 T-Emded-PN532 的主题切换和断电保存数据的功能；

04.11
验证新版的 T-Halow，摄像头和 TX-AH-Rxxp 连接正常，但是网口识别不到；搭建 T-Circle 的屏幕测试环境给测试那边；

04.12
网口不能识别的问题已经交给硬件看了，但是不好解决；编写 Mic 录音保存到 SD 卡的 demo，因为板子上没有 SD 座所以暂时没有测试；

04.13 ---

04.14 ---

04.15
完成验证新版的 T-Halow 板子摄像头、无线通信和网口等；添加 T-Emded-PN532 的参数保存功能和主题切换；

04.16
添加 T-Emded-PN532 红外遥控功能；添加录音测试代码，现在还有问题；帮助测试搭建 ICM20948 的测试环境；

04.17
完成搭建 ICM20948 的测试环境；完成录音保存到 SD 卡的演示例程，测试通过；

04.18
#问题 【T-Emded-PN532 】完成录音保存到 sd 卡功能到出厂程序；但是在录音时，遇到了有几率卡死的问题；
- 是因为项目的红外一直在扫描等待，并且使能了反馈 LED，但是板子上没有反馈灯，所以有概率导致程序崩溃；
~~~
使用库 z3t0/IRremote@^4.3.1

将代码中的：
IrReceiver.begin(BOARD_IR_RX, ENABLE_LED_FEEDBACK);
更改为：
IrReceiver.begin(BOARD_IR_RX, DISABLE_LED_FEEDBACK);
~~~

04.19
解决录音后卡死的问题，添加了 SD 内存使用的 UI；整理整个项目的代码；

04.20
测试代码在 Arduion 环境下的运行情况，并整理 T-Emded-PN532 项目代码和文档；编写中文和英文的 README.md 文档，并提交整个项目到 github上面；

04.21 ---

04.22
编写 T-Knob 中英文的 README.md 文档；完善 T-Embed-PN532 README 文档，发布 v1.0 固件；

04.23
验证的关于交互设计的 MVC 模型；更新 T-Embed-PN532 固件；

04.24
开始新版的 [LilyGo-EPD47](https://github.com/Xinyuan-LilyGO/LilyGo-EPD47) 项目，搭建项目环境，熟悉项目代码和原理图；

04.25
#问题 【LilyGo-EPD4】和硬件一起解决墨水屏不能显示和显示时屏幕过暗的问题；开始设计墨水屏的显示 UI 的布局；
- `1️⃣` 屏幕不能显示是因为芯片 (74HCT4094D) 引脚 strobe input (STR) 和 GND 短接了；
- `2️⃣` 屏幕过暗是控制板子亮暗的电位器阻值太小了；

04.26
#问题 【LilyGo-EPD4】协助硬件解决板子不能识别 SD 和 Lora 的问题，
- 不能识别 SD 是因为 SD 卡座有虚焊
- 不能识别 Lora 是因为 Lora 的插座容易松动，导致一会可以一会不行；

04.27 ---

04.28 ---

04.29
开始熟悉关于 EPD47 的代码， 开始根据原有的代码实现 UI；

04.30
实现显示 UI 的主界面和界面切换，但是效果不满意，开始设计实现另外的 UI；

## 5月

05.01 --- 

05.02
做出的 UI 不满意，准备规划新的 UI 显示方案，之前都是手动绘制的，UI 做不出很好看的；

05.03
研究现有 EPD 代码的接口，开始使用 LVGL 作为图像引擎来实现 UI，尝试用 LVGL 和墨水屏结合起来；

05.04 ---

05.05 ---

05.06
完成 LVGL 与墨水屏的对接，优化 LVGL 在墨水屏上显示，协助引脚验证新的 T-Embed-PN532

05.07
搭建 LVGL 墨水屏的 UI 框架，确定 UI 的显示方式、主页面布局和页面跳转方式；

05.08
完成墨水屏实现时钟的功能；

05.09 完成从 SD 读取图片显示到墨水屏上面；
#LVGL ESP32 使用 LVGL 读取 SD 卡文件； 需要修改的地方；
1. 在 `lv_conf.h` 中，将下面部分改为下图所示的样子：
![](image/Pasted%20image%2020240509142546.png)
2. 在 `lv_conf.h` 中使能 FATFS 文件系统；
![](image/Pasted%20image%2020240509142834.png)
3. 使用 LVGL 文件系统读取文件
~~~c
lv_obj_t *img = lv_img_create(lv_scr_act());
lv_obj_center(img);
lv_img_set_src(img, "S:/image.png");

/** 注意，在使用图片时，可以使用 LVGL 自带的图片解码器；需要在 lv_conf.h 中设置相应的宏；

#define LV_USE_PNG 1   // Enable PNG decoder library
#define LV_USE_BMP 1   // Enable BMP decoder library
#define LV_USE_SJPG 1  // Enable JPG + split JPG decoder library
#define LV_USE_GIF 1   // Enable GIF decoder library

*/
~~~

05.10
添加 SD 查看图片界面和 test 界面； 优化时钟界面显示时间和日历，优化 SD、test、Clock界面布局 (采用类似于平行视界的布局 )；

05.11
添加 lora、Setting、wifi 界面；整理墨水屏 UI 代码，优化交互逻辑；

05.12 --- 

05.13
编写 T-EPD47-S3 的README 说明文档；修复在 Arduion 环境下的编译错误；整理模拟器 UI 框架，便于以后得开发的修改；

05.14
完成配网功能，保存 WIFI 名和密码的 Flash 中；同步 README；

05.15
解决 T-Embed-PN532 在下载模式和非下载模式会识别到不同串口的问题；解决在 WIFI 界面返回会重启的问题；

05.16
完成 T-EPD47-S3 的整体开发完成，整体项目代码，更新README；

05.17
优化墨水屏的刷新，加快墨水屏的刷新速度，但是刷太快会有残影，后面继续优化；了解充电芯片 bq27220；

05.18 ---

05.19 ---

05.20
T-Embed-PN532 调试电量芯片 bq27220，因为没有库只能自己写一些测试函数，现在的问题是子命令不能正常运行，其他的指令可以运行，待解决；

05.21
为 T-Embed-PN532 测试扬声器，测试解决为当前扬声器可以正常使用；将 PN532 的UI移植到新的UI框架；

05.22

05.23

05.24

05.25

05.26 ---

05.27

05.28

05.29

05.30

05.31




