{"ID":"20240524163501-iv80qf6","Spec":"1","Type":"NodeDocument","Properties":{"icon":"1f604","id":"20240524163501-iv80qf6","tags":"LVGL","title":"lv_i18n 多语言支持","type":"doc","updated":"20240524212514"},"Children":[{"ID":"20240524203401-78dr910","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240524203401-78dr910","updated":"20240524212514"},"Children":[{"Type":"NodeText","Data":"1. 检查 node.js 环境"}]},{"ID":"20240524211751-pzq6bul","Type":"NodeParagraph","Properties":{"id":"20240524211751-pzq6bul","updated":"20240524212125"},"Children":[{"Type":"NodeText","Data":"检查 node.js 环境，打开命令行，输入一下命令，如果打印了版本号，则说明有 node.js，否则没有环境，可以点击下载安装 node.js "},{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://nodejs.cn/download/","TextMarkTextContent":"下载地址"},{"Type":"NodeText","Data":";"}]},{"ID":"20240524211859-5kcde8m","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240524211859-5kcde8m","updated":"20240524212352"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Y21k"},{"Type":"NodeCodeBlockCode","Data":"node -v\nnpm -v\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240524211540-hlx1q6e","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240524211540-hlx1q6e","updated":"20240524212514"},"Children":[{"Type":"NodeText","Data":"2. 安装 lv_i18n"}]},{"ID":"20240524212417-3vtw2av","Type":"NodeParagraph","Properties":{"id":"20240524212417-3vtw2av","updated":"20240524212554"},"Children":[{"Type":"NodeText","Data":"在命令行中输入 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"npm i lv_i18n -g"},{"Type":"NodeText","Data":"​ 安装 lv_i18n"}]},{"ID":"20240524212441-1gp6beu","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240524212441-1gp6beu","updated":"20240524212444"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Y21k"},{"Type":"NodeCodeBlockCode","Data":"npm i lv_i18n -g\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240524212514-eggavwz","Type":"NodeParagraph","Properties":{"id":"20240524212514-eggavwz","updated":"20240524212514"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 395px;","style":"width: 385px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240524212514-amop814.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 385px;\" parent-style=\"width: 395px;\"}"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240524212515-pvcpo5c","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240524212515-pvcpo5c","updated":"20240525170747"},"Children":[{"Type":"NodeText","Data":"3. lv_i18n 使用"}]},{"ID":"20240524213251-babx8rs","Type":"NodeParagraph","Properties":{"id":"20240524213251-babx8rs","updated":"20240524213341"},"Children":[{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://lvgl.100ask.net/8.2/tools/fonts-zh-source.html","TextMarkTextContent":"百问网生成中文教程"}]},{"ID":"20240525165631-j149lp2","Type":"NodeParagraph","Properties":{"id":"20240525165631-j149lp2","updated":"20240525170021"},"Children":[{"Type":"NodeText","Data":"以下是语言和区域设置代码的列表，使用 lv_i18n 需要为每个翻译语言创建一个 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":".yml"},{"Type":"NodeText","Data":"​ 文件，文件名需要依照 "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"语言和区域设置代码的列表"},{"Type":"NodeText","Data":" 命名；"}]},{"ID":"20240525165736-d7bukni","Type":"NodeParagraph","Properties":{"id":"20240525165736-d7bukni","updated":"20240525165806"},"Children":[{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://www.andiamo.co.uk/resources/iso-language-codes/","TextMarkTextContent":"语言和区域设置代码的列表"}]},{"ID":"20240524212739-llve76y","Type":"NodeParagraph","Properties":{"id":"20240524212739-llve76y","updated":"20240524213511"},"Children":[{"Type":"NodeText","Data":"以中英文转换为例，首先使用字体转换工具，生成包含中英文字体的 .c 文件；"}]},{"ID":"20240525171808-9w481tc","Type":"NodeParagraph","Properties":{"id":"20240525171808-9w481tc","updated":"20240525171808"},"Children":[{"Type":"NodeText","Data":"如果安装了 "},{"Type":"NodeTextMark","TextMarkType":"block-ref","TextMarkBlockRefID":"20240524203411-9njzsum","TextMarkBlockRefSubtype":"d","TextMarkTextContent":"lv_font_conv 离线字体转换"},{"Type":"NodeText","Data":" 工具，则可以使用命令行生成；"}]},{"ID":"20240524213512-4ka0ce7","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240524213512-4ka0ce7","updated":"20240524213537"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Y21k"},{"Type":"NodeCodeBlockCode","Data":"lv_font_conv --no-compress --format lvgl --font .\\simkai.ttf -o .\\conv\\simkai_20.c --bpp 4 --size 20 --symbols 你好世界 -r 0x20-0x7F\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240524213538-tz03xig","Type":"NodeParagraph","Properties":{"id":"20240524213538-tz03xig","updated":"20240524213913"},"Children":[{"Type":"NodeText","Data":"中英文字体 .c 文件生成后，在 font 文件夹内，创建两个文件 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"en-us.yml"},{"Type":"NodeText","Data":"​ 和 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"zh-cn.yml"},{"Type":"NodeText","Data":"​；"}]},{"ID":"20240524213710-s16qkpe","Type":"NodeParagraph","Properties":{"id":"20240524213710-s16qkpe","updated":"20240524213822"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"en-us.yml"},{"Type":"NodeText","Data":"​ 文件输入以下内容："}]},{"ID":"20240524213734-i3mrxmj","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240524213734-i3mrxmj","updated":"20240524213754"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"eW1s"},{"Type":"NodeCodeBlockCode","Data":"'en-us':\n  menu: menu\n  name: Dylan\n  title1: title1\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240524213744-7cdvkf0","Type":"NodeParagraph","Properties":{"id":"20240524213744-7cdvkf0","updated":"20240524213818"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"zh-cn.yml"},{"Type":"NodeText","Data":"​ 文件输入以下内容："}]},{"ID":"20240524213819-kob8ja2","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240524213819-kob8ja2","updated":"20240524213833"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"eW1s"},{"Type":"NodeCodeBlockCode","Data":"'zh-cn':\n  menu: 目录\n  name: 名字\n  title1: 标题一\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240524213834-t83r00g","Type":"NodeParagraph","Properties":{"id":"20240524213834-t83r00g","updated":"20240524214024"},"Children":[{"Type":"NodeText","Data":"然后在当前目录下，打开 cmd 命令行，输入命令:"}]},{"ID":"20240524214024-h2rpjqe","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240524214024-h2rpjqe","updated":"20240524214045"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Y21k"},{"Type":"NodeCodeBlockCode","Data":"lv_i18n compile -t *.yml -l zh-cn -o .\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240524214324-eyxq4om","Type":"NodeParagraph","Properties":{"id":"20240524214324-eyxq4om","updated":"20240524214550"},"Children":[{"Type":"NodeText","Data":"运行成功后，会在当前目录生成 lv_i18n.c 和 lv_i18n.h，将这两个文件包含进自己的工程后，在工程添加如下代码："}]},{"ID":"20240524214550-koh1t6e","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240524214550-koh1t6e","updated":"20240524215052"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Qw=="},{"Type":"NodeCodeBlockCode","Data":"#include \"lv_i18n.h\"\n\n// 填 en-us.yml 的标头，如 menu、name、title1，点击按键\n// lv_i18n 自动的将英文转换为对应的中文\nconst char *test_str = \"name\"; \n\nlv_obj_t* label1;  \nbool state = false;\n\nvoid callback(lv_event_t* e) {\n    if (state) {\n        lv_i18n_set_locale(\"en-us\");\n    }\n    else {\n        lv_i18n_set_locale(\"zh-cn\");\n    }\n    lv_label_set_text(label1, _(test_str));\n    state = !state;\n    printf(\"hellow\\n\");\n}\n\nvoid lvgl_app(void)\n{\n\tlv_i18n_init(lv_i18n_language_pack);\n    lv_i18n_set_locale(\"en-us\");\n    label1 = lv_label_create(lv_scr_act());\n    lv_obj_set_style_text_font(label1, \u0026Font_Mono_Bold_20, 0); // Font_Mono_Bold_20 字体包含中英文\n    lv_obj_align(label1, LV_ALIGN_CENTER, 0, 100);\n    lv_label_set_text(label1, _(test_str));\n    lv_obj_t* btn = lv_obj_create(lv_scr_act());\n    lv_obj_align(btn, LV_ALIGN_CENTER, 0, 0);\n    lv_obj_set_size(btn,50,50);\n    lv_obj_set_style_bg_color(btn, lv_color_hex(0x335566), 0);\n    lv_obj_add_event_cb(btn, callback, LV_EVENT_CLICKED, NULL);\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240524214803-5tpzz4i","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240524214803-5tpzz4i","updated":"20240525170747"},"Children":[{"Type":"NodeText","Data":"4. Windows 命令行脚本"}]},{"ID":"20240525170640-sask72z","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240525170640-sask72z","updated":"20240525170747"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Y21k"},{"Type":"NodeCodeBlockCode","Data":"@echo off\nREM 关闭回显\n\nREM 输入*.yml路径和编译输出路径\nset yml_path=assets\nset out_path=.\\..\\ui_base\\assets\n\nREM 使用 for /f 命令执行 node -v 并捕获输出\nfor /f \"tokens=*\" %%i in ('npm -v') do set \"param=%%i\"\n\nfor /f \"tokens=*\" %%i in ('node -v') do set \"param1=%%i\"\n\nfor /f \"tokens=*\" %%i in ('lv_i18n -v') do set \"lv_i18n=%%i\"\n\nREM 输出捕获到的版本信息\necho \"********************************\"\necho \"npm version: %param%\"\necho \"node version: %param1%\"\necho \"lv_i18n version: %lv_i18n%\"\necho \"lv_i18n compile -t %yml_path%\\*.yml -l zh-cn -o %out_path%\"\necho \"********************************\"\n\nREM 如果没有 node.js 环境直接退出\nif \"%param%\" == \"0\" (\n    echo \"No `node.js` environment found\"\n    exit /b 1\n)\n\nREM 如果没有安装 lv_i18n, 并且有 node.js 环境，则安装 lv_i18n\nif \"%lv_i18n%\" == \"0\" (\n    if not \"%param%\" equ \"0\" (\n        echo \"install lv_i18n\"\n        @REM 安装 lv_i18n\n        npm i lv_i18n -g\n    )\n) else (\n    echo \"lv_i18n compile ...\"\n    @REM 编译 lv_i18n\n    @REM cd lvgl_examples\\T_DeckPro\\assets\n    for /f \"tokens=*\" %%i in ('lv_i18n compile -t %yml_path%\\*.yml -l zh-cn -o %out_path%') do set \"ret_val=%%i\"\n)\n\nREM 如果啥也没有返回，表示 lv_i18n 编译生成成功\nif \"%ret_val%\" == \"\" (\n    echo \"lv_i18n create succeed!\"\n) else (\n    echo \"lv_i18n create failed!\"\n)\n\npause\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}